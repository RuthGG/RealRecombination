2020-04-01 RealRecombination structure was created.
2020-04-13 Manually download data for a breakseq test:
	# TOOL VERSION: 2.10.4
	cd data/raw 
	mkdir avery_SRA_key avery_SRA avery_fastq
	# Downloaded SRA key for this dataset prj_21579.ngc into data/raw/avery_SRA_key (manually).
	# Wrote into rawdata readme (manually).
	# Copied directory structure into Crick (manually).
	vdb-config -i
	# I make sure that the "Cache" tab has "local file-caching" enabled and set the "public user-repository" to 20200401_RealRecombination/data/raw/avery_SRA (manually).
	# Prefetch:
	prefetch --max_size 100000000 --ngc avery_SRA_key/prj_21579.ngc  SRR10140422
	prefetch --max_size 100000000 --ngc avery_SRA_key/prj_21579.ngc  SRR10140423
	# Fastq conversion - I store it into Crick:
	cd avery_SRA/sra/sra/
	fastq-dump --ngc ../../../avery_SRA_key/prj_21579.ngc  -O /run/user/1001/gvfs/sftp:host=crick.uab.cat,user=rgomez/home/rgomez/20200401_RealRecombination/data/raw/avery_fastq SRR10140422.sra 
	# Read 440677597 spots for SRR10140422.sra
	# Written 440677597 spots for SRR10140422.sra
	fastq-dump --ngc ../../../avery_SRA_key/prj_21579.ngc  -O ../../../avery_fastq SRR10140423.sra
	# Read 399028996 spots for SRR10140423.sra
	# Written 399028996 spots for SRR10140423.sra
	cd ../../../avery_fastq/
	bgzip SRR10140423.fastq
	mv SRR10140423.fastq.gz /run/user/1001/gvfs/sftp:host=crick.uab.cat,user=rgomez/home/rgomez/20200401_RealRecombination/data/raw/avery_fastq
2020-04-14 Manually copied avery_individuals data.
2020-04-15: runall.sh all -a hg19 -i data/raw/avery_individuals -s 5: DISCARDED because .strand files were wrong.
2020-04-15: runall.sh all -a hg19 -i data/raw/avery_individuals -s 10: Stopped after `download` and `preprocess` to improve `merge`. 
2020-04-16: runall.sh merge -s 5 -r data/raw/1000genomes_hg19 -i data/use/avery_individuals: `merge` successfully finished. Ignored results because they are too heavy for git. 
2020-04-17: Manually copied the results in analysis/2020-04-16_mergePca from Muscul to local.
2020-04-17: Manually copied the file with population information from 1000k genomes to data/raw/1000genomes_hg19/integrated_call_samples_v3.20130502.ALL.panel
2020-04-18: runall.sh pca -f analysis/2020-04-16_mergePca/final_vcf.vcf.gz
2020-04-20: breakseq test worked wonderfully. I'll download the rest of the files. The list is in data/raw/avery_SRA_accessionlist/accession_list.txt but I won't make it automatic due to space issues. I'll put a runall option to do all the downloading and saving into crick.
2020-04-20: runall.sh dbgap -d SRR10140453: Didn't work because license was obsolete 
2020-04-20: runall.sh pcaplot -f analysis/2020-04-18_04_runPca/pcaResult.Rdata -p data/raw/1000genomes_hg19/integrated_call_samples_v3.20130502.ALL.panel
2020-04-21: Manually added previous reports.
2020-04-21: Created or moved parameter and imput files for imputation:
	# Manually copied directory data/raw/1000genomes_hg19_maps
	# Manually copied data/use/avery_individuals/samples_population.txt
	# Changed data/use/avery_individuals/samples_population.txt to make individual 25 AFR
	# Manually copied `inversions_info` into raw and use data.
	mkdir data/use/conditions
	# Manually created imputConditions.txt
2020-04-21: Added IMPUTE2 to the software directory. 
2020-04-21: Added QCTool to the software directory.
2020-04-22: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 10: there was a small error in the output files - a tab at the end of each line
2020-04-24: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 10: solved the error with the new code but using just the requied bits and maintaining the previous date to avoid re-running all the imputation
2020-04-26: runall.sh imputetables -i analysis/2020-04-22_06_imputation/ -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt
2020-04-27: Manually created conditions for tag SNP checking
2020-04-27: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv -s 10: there was a small error in the output file concatenation. DISCARDED to have the same format in all of them.
2020-04-28: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv -s 10:  solved the error with the new code but using just the requied bits and maintaining the previous date to avoid re-running all the tag SNPs check. DISCARDED to have the same format in all of them. 
2020-04-28: I did a summary genotype file with R:
	R 
			one<-read.table("data/use/inversions_info/all_genotypes.csv", sep = "\t", header = TRUE)
			two<-read.table("analysis/2020-04-26_07_imputationTables/new_genotypes.csv", header = TRUE)
			colnames(two)[1]<-colnames(one)[1]
			genotypes<-plyr::rbind.fill(one, two)
			write.table(genotypes,   "data/use/inversions_info/all+new_genotypes.csv", quote = FALSE, sep = "\t", na = ".", row.names = FALSE, col.names = TRUE) 
2020-04-28: Manually added a population file to analysis/2020-04-16_mergePca to use this dataset 
2020-04-28: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 10. DISCARDED to have the same format in all of them.
2020-04-28: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 10. DISCARDED to have the same format in all of them.
2020-04-29: Manually added information related to inversions in hg38
2020-04-29: Manually updated data READMEs
2020-05-05: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv. DISCARDED - see 2020-07-07
2020-05-06: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv. DISCARDED - see 2020-07-07
2020-05-11: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 3: SAS population. DISCARDED because there were evident errors in such big files.
2020-05-12: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 5: other populations. DISCARDED because there were evident errors in such big files.
2020-05-13: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 7: ALL population. DISCARDED because there were evident errors in such big files.
2020-05-17: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 10: DISCARDED because there was an error in the data that made almos all SNPs missing.
2020-05-23: runall.sh imputetables -i analysis/2020-04-22_06_imputation/ -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt. This applied less strict filters to imputation results.
2020-05-23: I did a summary genotype file with R:
	R 
			one<-read.table("data/use/inversions_info/all_genotypes.csv", sep = "\t", header = TRUE)
			two<-read.table("analysis/2020-05-23_07_imputationTables/new_genotypes.csv", header = TRUE)
			colnames(two)[1]<-colnames(one)[1]
			genotypes<-plyr::rbind.fill(one, two)
			write.table(genotypes,   "data/use/inversions_info/all+new_genotypes_lessStrict.csv", quote = FALSE, sep = "\t", na = ".", row.names = FALSE, col.names = TRUE) 
2020-05-23: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes_lessStrict.csv -s 8
2020-05-23: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/
2020-05-29: Manually copied data/use/assembly_hg38/gap.txt
2020-05-29: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-06-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-06-30: manually changed the name to 2020-06-30_09_crossovers_fixed. DISCARDED - see 2020-07-07
2020-06-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-06-30: manually changed the name to 2020-06-30_09_crossovers_proportional. DISCARDED - see 2020-07-07
2020-07-01: awk '$2 == 0 {a[$1]=$3}; $4 == "telomere" && $2 !=0 {print $1,a[$1] , $2}' data/use/assembly_hg38/gap.txt | grep -v "chrX" | grep -v "chrY" | awk -v OFS="\t" '{}{print $1,"InvFEST", "inversion",$2, $3, ".",".",".",$1 }' > data/use/assembly_hg38/cromlength.txt
2020-07-01: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-07-01: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-07-07: Discarded all previous crossover tests because I want brand new ones. 
2020-07-14: data/use/avery_crossovers/numOfCells.txt was manually created. Columns: individual \t numberofcells
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_inv10kb
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_inv50kb
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_generalMap
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_byChromosome
2020-07-14: Manually copied data/use/avery_crossovers/allcrossovers.bed that contains crossovers simplified, and also saved as an Rdata file.
2020-07-15: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
2020-07-29: zcat data/raw/avery_crossovers/allcrossovers_hg38.txt.gz | awk -v OFS="\t" -v CONVFMT="%.0f" 'NR>1{number=int(($4+$5)/2); $4 = number; $5 = number+1}{print}' | gzip > data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz
2020-07-29:  Paper-like recombination maps of different sizes - this means, with 1 point recombination events. 

		printf "500000\n0" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-07-29_09_crossovers analysis/2020-07-29_09_crossovers_paperMap500
		printf "100000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-07-29_09_crossovers analysis/2020-07-29_09_crossovers_paperMap100
		printf "10000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-07-29_09_crossovers analysis/2020-07-29_09_crossovers_paperMap10

2020-07-29:  Proportional recombination maps of different sizes
		
		printf "500000\n0" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-07-29_09_crossovers analysis/2020-07-29_09_crossovers_newMap500
		printf "100000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-07-29_09_crossovers analysis/2020-07-29_09_crossovers_newMap100
		printf "10000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-07-29_09_crossovers analysis/2020-07-29_09_crossovers_newMap10

2020-07-30: Manually created data/use/inversions_info/2020.07.inversions_hg38 (.csv and.gff): awk -v OFS="\t" '{print "chr"$1, "InvFEST", "inversion", $3, $6, ".", ".", ".", "ID=1;Name="$2";Estimated size ="$8" bp"}' data/use/inversions_info/2020.07.inversions_hg38.csv > data/use/inversions_info/2020.07.inversions_hg38.gff
2020-07-30: Manually created data/use/inversions_info/2020.07.biginversions_hg38.gff to make a detailed study. 
2020-07-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.biginversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
2020-07-30: Manually changed 2020-07-30_09_crossovers to 2020-07-30_09_crossovers_biginversions
2020-07-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
2020-07-30: Manually changed 2020-07-30_09_crossovers to 2020-07-30_09_crossovers_inversions
2020-08-24: New proportional recombination maps of different sizes
		
		printf "50000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_newMap50
		printf "20000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_newMap20
		printf "100000\n0" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_newMap100
		printf "500000\n0" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_newMap500

2020-08-24:  New paper-like recombination maps of different sizes - this means, with 1 point recombination events. 

		printf "500000\n0" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_paperMap500
		printf "100000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_paperMap100
		printf "20000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_paperMap20
		printf "50000\n0" > data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/use/avery_crossovers/allcrossovers_hg38_midpoint.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
		mv analysis/2020-08-24_09_crossovers analysis/2020-08-24_09_crossovers_paperMap50

2020-08-24: Manually created data/use/inversions_info/2020.08.inversions_hg38.gff
2020-08-24: Manually created data/use/inversions_info/2020.08.inversions_hg38_G1.gff (up to 5kb), data/use/inversions_info/2020.08.inversions_hg38_G2.gff (5-50kb), data/use/inversions_info/2020.08.inversions_hg38_G3.gff (more than 50kb)
2020-08-25: Samples for inversions analysis, in three groups, with two methods

		printf "50000\n250000" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G1.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -w out
		mv analysis/2020-08-25_09_crossovers analysis/2020-08-25_09_crossovers_invsG1o
		cp project/logfiles/2020-08-25 analysis/2020-08-25_09_crossovers_invsG1o

		printf "50000\n500000" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G2.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -w out
		mv analysis/2020-08-25_09_crossovers analysis/2020-08-25_09_crossovers_invsG2o
		cp project/logfiles/2020-08-25 analysis/2020-08-25_09_crossovers_invsG2o

		printf "50000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G3.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -w out
		mv analysis/2020-08-25_09_crossovers analysis/2020-08-25_09_crossovers_invsG3o
		cp project/logfiles/2020-08-25 analysis/2020-08-25_09_crossovers_invsG3o

		printf "50000\n250000" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G1.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -w all
		mv analysis/2020-08-25_09_crossovers analysis/2020-08-25_09_crossovers_invsG1a
		cp project/logfiles/2020-08-25 analysis/2020-08-25_09_crossovers_invsG1a

		printf "50000\n500000" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G2.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -w all
		mv analysis/2020-08-25_09_crossovers analysis/2020-08-25_09_crossovers_invsG2a
		cp project/logfiles/2020-08-25 analysis/2020-08-25_09_crossovers_invsG2a

		printf "50000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
		bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G3.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -w all
		mv analysis/2020-08-25_09_crossovers analysis/2020-08-25_09_crossovers_invsG3a
		cp project/logfiles/2020-08-25 analysis/2020-08-25_09_crossovers_invsG3a

2020-09-26: printf "50000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
			runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G3.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
			mv analysis/2020-09-26_09_crossovers analysis/2020-09-26_09_crossovers_invsG3
2020-09-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G3.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt
2020-10-01: Manually created a minimum SNP mask
  for FILE in $(ls  data/use/avery_individuals/ | grep "gz$"); do 
	bcftools view -H -f PASS data/use/avery_individuals/${FILE} | head -n 1 >> tmp/minmaxchr.txt
	bcftools view -H -f PASS data/use/avery_individuals/${FILE} | tail -n 1 >> tmp/minmaxchr.txt
  done
  Manually converted two lines into one for each chromosome (start - end) and now the end position is added in position 3
  awk -v OFS="\t" '{print "chr"$1,"Avery2020", "chromosome",$2, $3, ".",".",".","PASS;Name=chr"$1 }' tmp/minmaxchr.txt > data/use/assembly_hg38/minmax.gff
2020-10-02: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G3.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.gff
			mv analysis/2020-10-02_09_crossovers analysis/2020-10-02_09_crossovers_invsG32020-10-05: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G4.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.gff

2020-10-14: Manually added minmax.strict.gff that is 500kb inwards from the first and last PASS SNPs of each chromosome 
2020-10-14: Medium and big windows worked correctly

			printf "50000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
			bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
			cp project/logfiles/2020-10-14 analysis/2020-10-14_09_crossovers
			mv analysis/2020-10-14_09_crossovers analysis/2020-10-14_09_crossovers_50k

			printf "200000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
			bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
			cp project/logfiles/2020-10-14 analysis/2020-10-14_09_crossovers
			mv analysis/2020-10-14_09_crossovers analysis/2020-10-14_09_crossovers_200k

2020-10-15: Let's go with small windows

			printf "10000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
			bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
			cp project/logfiles/2020-10-15 analysis/2020-10-15_09_crossovers
			mv analysis/2020-10-15_09_crossovers analysis/2020-10-15_09_crossovers_10k

2020-10-15: For normalization validation

			printf "200000\n0" >  data/use/conditions/winsizeCrossovers.txt
			bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G4.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
			cp project/logfiles/2020-10-15 analysis/2020-10-15_09_crossovers
			mv analysis/2020-10-15_09_crossovers analysis/2020-10-15_09_crossovers_allMap200
			python code/python/quantileNormalization_formaps.py --input tmp/2020-10-15_09_crossovers/crossoverResult.txt --output "tmp/crossoverResult.new_QN.txt" --recMap data/use/recMaps/recMap_200000.txt 
2020-10-19: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
2020-10-19: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
2020-10-19: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38_G4.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
2020-10-19: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38_G4.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G4.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
2020-10-19: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.08.inversions_hg38_G4.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff

# RE-PROCESSING DATA AND REDOING IMPUTATION TO AVOID SNP LOSS

2020-12-11: runall.sh preprocess -i data/raw/avery_individuals/nc17nc18 -r data/raw/chains
2020-12-11: runall.sh preprocess -i data/raw/avery_individuals/nc6nc22nc25nc26 -r data/raw/chains
2020-12-11: runall.sh preprocess -i data/raw/avery_individuals/all14samps -r data/raw/chains

2020-12-17: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc17nc18 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/20201217_all_genotypes.csv -s 10
mv analysis/2020-12-17_06_imputation analysis/2020-12-17_06_imputation_nc17nc18
2020-12-17: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc6nc22nc25nc26 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/20201217_all_genotypes.csv -s 14
mv analysis/2020-12-17_06_imputation analysis/2020-12-17_06_imputation_nc6nc22nc25nc26
2020-12-18: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/20201217_all_genotypes.csv -s 14
mv analysis/2020-12-18_06_imputation analysis/2020-12-17_06_imputation_all14samps



# MANUAL MERGE OF VCFS

mkdir analysis/2020-12-17_06_imputation_merged 
CONLIST=$(cut -f1 data/use/conditions/imputConditions.txt )

for CONDITION in $CONLIST;do
	CPARSED=$(echo $CONDITION | sed 's/,/_/' )
	ls analysis/2020-12-17_06_imputation_*/${CPARSED}_readSum.vcf > analysis/2020-12-17_06_imputation_merged/list_${CPARSED}.txt 
	NUMLINES=$(grep "^.*$" -c  analysis/2020-12-17_06_imputation_merged/list_${CPARSED}.txt  )
	if [ $NUMLINES == 1 ]; then
	cp $(cat analysis/2020-12-17_06_imputation_merged/list_${CPARSED}.txt) analysis/2020-12-17_06_imputation_merged
	else
	echo  ${CPARSED} >> analysis/2020-12-17_06_imputation_merged/multilist.txt
	fi
done

	R:

		 multilist <- readLines("analysis/2020-12-17_06_imputation_merged/multilist.txt")
		 
		 for (m in multilist) { 
		 	filelist <- readLines( paste0("analysis/2020-12-17_06_imputation_merged/list_",m,".txt"))
		 	merged<-read.table(filelist[1], sep = "\t", comment.char="", skip=2, header = TRUE, check.names = FALSE)
		 	header <- readLines(filelist[1], n  = 2)
		 	for (f in filelist[c(2:length(filelist))]){
		 		merged<-merge(read.table(f, sep = "\t", comment.char="", skip = 2, header = TRUE, check.names = FALSE), merged, all.y = TRUE)
		 	}
		 	write(header,paste0("analysis/2020-12-17_06_imputation_merged/", m , "_readSum.vcf") ) 
		 	write.table(merged, paste0("analysis/2020-12-17_06_imputation_merged/", m , "_readSum.vcf"), quote = FALSE, sep = "\t", row.names = FALSE, append = TRUE)
		 }


# PIPELINE FROM HERE DOWN AS NORMAL

2021-01-11: runall.sh imputetables -i analysis/2020-12-17_06_imputation_merged -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt


# Tag SNPs genotyping

DATE="2021-01-07"
mkdir analysis/${DATE}_tagsnps_all
for FILE in v4.7 v5 ; do
  for SAMPLES in all14samps nc17nc18 nc6nc22nc25nc26 ; do  
    bash runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_${FILE} -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/${SAMPLES} -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv
	cp project/logfiles/${DATE} analysis/${DATE}_08_tagsnps
    mv analysis/${DATE}_08_tagsnps analysis/${DATE}_tagsnps_all/${FILE}_${SAMPLES}
  done
done

# Automatic messages
2021-01-07: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv
2021-01-07: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/nc17nc18 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv
2021-01-07: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/nc6nc22nc25nc26 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv
2021-01-07: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v5 -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv
2021-01-07: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v5 -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/nc17nc18 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv
2021-01-07: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v5 -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals/nc6nc22nc25nc26 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -r data/raw/1000genomes_hg19 -g data/use/inversions_info/20201217_all_genotypes.csv

# Join all
echo -e "Individual\tGenotype\tProbability\tAvail.TagSNPs\tExist.tagSNPs\tInversion\tPopulation" > analysis/${DATE}_tagsnps_all/tagSNPGenotypedInvs_conc.txt
for DIR in `ls -d  analysis/${DATE}_tagsnps_all/*/`; do 
	cat $DIR/tagSNPGenotypedInvs.txt | tail -n+2 >> analysis/${DATE}_tagsnps_all/tagSNPGenotypedInvs_conc.txt
done

# Coverage assessment - in imputation range is 500000

2021-01-08: runall.sh coverage -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/coverageConditions.txt -r data/raw/1000genomes_hg19 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -i data/use/avery_individuals/all14samps
2021-01-10: runall.sh coverage -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/coverageConditions.txt -r data/raw/1000genomes_hg19 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -i data/use/avery_individuals/nc6nc22nc25nc26
2021-01-11: runall.sh coverage -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/coverageConditions.txt -r data/raw/1000genomes_hg19 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -i data/use/avery_individuals/nc17nc18

2021-01-11: Manually join all files
	mkdir analysis/2021-01-11_09_coverage_allinds
	cat analysis/2021-01-08_09_coverage/coverage_table.txt > analysis/2021-01-11_09_coverage_allinds/coverage_table.txt
	tail -n+2 analysis/2021-01-10_09_coverage/coverage_table.txt >> analysis/2021-01-11_09_coverage_allinds/coverage_table.txt
	tail -n+2 analysis/2021-01-11_09_coverage/coverage_table.txt >> analysis/2021-01-11_09_coverage_allinds/coverage_table.txt2021-02-15: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/20201217_all_genotypes.csv -s 3

# Repeat imputation for DEL genotype inversions

2021-02-16: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 3
mv analysis/2021-02-16_06_imputation analysis/2021-02-16_06_imputation_all14samps
2021-02-16: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc6nc22nc25nc26 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 3
mv analysis/2021-02-16_06_imputation analysis/2021-02-16_06_imputation_nc6nc22nc25nc26
2021-02-16: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc17nc18 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 3
mv analysis/2021-02-16_06_imputation analysis/2021-02-16_06_imputation_nc17nc18

DATE=2021-02-16
rm analysis/${DATE}_06_imputation_merged/*
mkdir analysis/${DATE}_06_imputation_merged
CONLIST=$(cut -f1 data/use/conditions/imputConditions.txt )

for CONDITION in $CONLIST;do
	CPARSED=$(echo $CONDITION | sed 's/,/_/' )
	FLIST=$(ls analysis/${DATE}_06_imputation_*/${CPARSED}_readSum.vcf)
	echo -n "" > analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt 
	for FILE in $FLIST; do
		LINESN=$(grep "^.*$" -c  $FILE  )
		if [ $LINESN != 0 ]; then
			echo $FILE >> analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt 
		fi
	done
	NUMLINES=$(grep "^.*$" -c  analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt  )
	#	echo $CPARSED $NUMLINES
	if [ $NUMLINES == 0 ]; then
		echo "No lines in ${CPARSED}"
	elif [ $NUMLINES == 1 ]; then
		cp $(cat analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt) analysis/${DATE}_06_imputation_merged
	else
		echo ${CPARSED}
		echo  ${CPARSED} >> analysis/${DATE}_06_imputation_merged/multilist.txt
	fi

done

	R:
		date<-"2021-02-16"
		 multilist <- readLines(paste0("analysis/",date,"_06_imputation_merged/multilist.txt"))
		 
		 for (m in multilist) { 
		 	filelist <- readLines( paste0("analysis/",date,"_06_imputation_merged/list_",m,".txt"))
		 	merged<-read.table(filelist[1], sep = "\t", comment.char="", skip=2, header = TRUE, check.names = FALSE)
		 	header <- readLines(filelist[1], n  = 2)
		 	for (f in filelist[c(2:length(filelist))]){
		 		merged<-merge(read.table(f, sep = "\t", comment.char="", skip = 2, header = TRUE, check.names = FALSE), merged, all.y = TRUE)
		 	}
		 	write(header,paste0("analysis/",date,"_06_imputation_merged/", m , "_readSum.vcf") ) 
		 	write.table(merged, paste0("analysis/",date,"_06_imputation_merged/", m , "_readSum.vcf"), quote = FALSE, sep = "\t", row.names = FALSE, append = TRUE)
		 }

2021-02-16: runall.sh imputetables -i analysis/2021-02-16_06_imputation_merged -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt
			mv analysis/2021-02-16_07_imputationTables analysis/2021-02-16_07_imputationTables_DELinvs


# Impute HsInv0501 from a different panel

2021-02-16: manually copied file in data/raw/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf and data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf
			cd data/use/inversions_info/HsInv0501_haplotypes/
			bgzip haplotypes_EUR.vcf 
			tabix -p vcf haplotypes_EUR.vcf.gz
2021-02-18: Added coordinate information for HsInv0501 to data/raw/inversions_info/HsInv0501_haplotypes
2021-02-18: Changed data/use/inversions_info/Inversions_coordinates_hg19.csv to contain HsInv0501 coordinates in hg19 (previously in hg18 due to an error)

2021-02-18: runall.sh imputeREF -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf.gz -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 1
mv analysis/2021-02-18_06_imputation analysis/2021-02-18_06_imputation_all14samps
2021-02-18: runall.sh imputeREF -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf.gz -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc6nc22nc25nc26 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 1
mv analysis/2021-02-18_06_imputation analysis/2021-02-18_06_imputation_nc6nc22nc25nc26
2021-02-18: runall.sh imputeREF -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf.gz -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc17nc18 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 1
mv analysis/2021-02-18_06_imputation analysis/2021-02-18_06_imputation_nc17nc18

DATE=2021-02-17
rm analysis/${DATE}_06_imputation_merged/*
mkdir analysis/${DATE}_06_imputation_merged
CONLIST=$(cut -f1 data/use/conditions/imputConditions.txt )

for CONDITION in $CONLIST;do
	CPARSED=$(echo $CONDITION | sed 's/,/_/' )
	FLIST=$(ls analysis/${DATE}_06_imputation_*/${CPARSED}_readSum.vcf)
	echo -n "" > analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt 
	for FILE in $FLIST; do
		LINESN=$(grep "^.*$" -c  $FILE  )
		if [ $LINESN != 0 ]; then
			echo $FILE >> analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt 
		fi
	done
	NUMLINES=$(grep "^.*$" -c  analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt  )
	#	echo $CPARSED $NUMLINES
	if [ $NUMLINES == 0 ]; then
		echo "No lines in ${CPARSED}"
	elif [ $NUMLINES == 1 ]; then
		cp $(cat analysis/${DATE}_06_imputation_merged/list_${CPARSED}.txt) analysis/${DATE}_06_imputation_merged
	else
		# echo ${CPARSED}
		echo  ${CPARSED} >> analysis/${DATE}_06_imputation_merged/multilist.txt
	fi

done

	R:
		date<-"2021-02-17"
		 multilist <- readLines(paste0("analysis/",date,"_06_imputation_merged/multilist.txt"))
		 
		 for (m in multilist) { 
		 	filelist <- readLines( paste0("analysis/",date,"_06_imputation_merged/list_",m,".txt"))
		 	merged<-read.table(filelist[1], sep = "\t", comment.char="", skip=2, header = TRUE, check.names = FALSE)
		 	header <- readLines(filelist[1], n  = 2)
		 	for (f in filelist[c(2:length(filelist))]){
		 		merged<-merge(read.table(f, sep = "\t", comment.char="", skip = 2, header = TRUE, check.names = FALSE), merged, all.y = TRUE)
		 	}
		 	write(header,paste0("analysis/",date,"_06_imputation_merged/", m , "_readSum.vcf") ) 
		 	write.table(merged, paste0("analysis/",date,"_06_imputation_merged/", m , "_readSum.vcf"), quote = FALSE, sep = "\t", row.names = FALSE, append = TRUE)
		 }

2021-02-17: runall.sh imputetables -i analysis/2021-02-17_06_imputation_merged -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt
2021-02-17: 
	
	mv analysis/2021-02-17_07_imputationTables analysis/2021-02-17_07_imputationTables_HsInv0501






2021-12-18: Manually added HsInv0501 to data/use/inversions_info/2020.08.inversions_hg38.gff. The coordinates from the hg38 conversion project were estimated.

			printf "200000\n1000000" >  data/use/conditions/winsizeCrossovers.txt
			bash runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.07.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt -m data/use/recMaps -b data/use/assembly_hg38/minmax.strict.gff
			cp project/logfiles/2020-10-14 analysis/2020-10-14_09_crossovers
			mv analysis/2020-10-14_09_crossovers analysis/2020-10-14_09_crossovers_200k


#####
2021-02-18: runall.sh imputeREF -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf.gz -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/all14samps -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 1
2021-02-18: runall.sh imputeREF -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf.gz -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc6nc22nc25nc26 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 1
2021-02-18: runall.sh imputeREF -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/use/inversions_info/HsInv0501_haplotypes/haplotypes_EUR.vcf.gz -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals/nc17nc18 -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 1
2021-02-18: runall.sh imputetables -i analysis/2021-02-18_06_imputation_merged -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt
