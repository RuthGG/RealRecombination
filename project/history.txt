2020-04-01 RealRecombination structure was created.
2020-04-13 Manually download data for a breakseq test:
	# TOOL VERSION: 2.10.4
	cd data/raw 
	mkdir avery_SRA_key avery_SRA avery_fastq
	# Downloaded SRA key for this dataset prj_21579.ngc into data/raw/avery_SRA_key (manually).
	# Wrote into rawdata readme (manually).
	# Copied directory structure into Crick (manually).
	vdb-config -i
	# I make sure that the "Cache" tab has "local file-caching" enabled and set the "public user-repository" to 20200401_RealRecombination/data/raw/avery_SRA (manually).
	# Prefetch:
	prefetch --max_size 100000000 --ngc avery_SRA_key/prj_21579.ngc  SRR10140422
	prefetch --max_size 100000000 --ngc avery_SRA_key/prj_21579.ngc  SRR10140423
	# Fastq conversion - I store it into Crick:
	cd avery_SRA/sra/sra/
	fastq-dump --ngc ../../../avery_SRA_key/prj_21579.ngc  -O /run/user/1001/gvfs/sftp:host=crick.uab.cat,user=rgomez/home/rgomez/20200401_RealRecombination/data/raw/avery_fastq SRR10140422.sra 
	# Read 440677597 spots for SRR10140422.sra
	# Written 440677597 spots for SRR10140422.sra
	fastq-dump --ngc ../../../avery_SRA_key/prj_21579.ngc  -O ../../../avery_fastq SRR10140423.sra
	# Read 399028996 spots for SRR10140423.sra
	# Written 399028996 spots for SRR10140423.sra
	cd ../../../avery_fastq/
	bgzip SRR10140423.fastq
	mv SRR10140423.fastq.gz /run/user/1001/gvfs/sftp:host=crick.uab.cat,user=rgomez/home/rgomez/20200401_RealRecombination/data/raw/avery_fastq
2020-04-14 Manually copied avery_individuals data.
2020-04-15: runall.sh all -a hg19 -i data/raw/avery_individuals -s 5: DISCARDED because .strand files were wrong.
2020-04-15: runall.sh all -a hg19 -i data/raw/avery_individuals -s 10: Stopped after `download` and `preprocess` to improve `merge`. 
2020-04-16: runall.sh merge -s 5 -r data/raw/1000genomes_hg19 -i data/use/avery_individuals: `merge` successfully finished. Ignored results because they are too heavy for git. 
2020-04-17: Manually copied the results in analysis/2020-04-16_mergePca from Muscul to local.
2020-04-17: Manually copied the file with population information from 1000k genomes to data/raw/1000genomes_hg19/integrated_call_samples_v3.20130502.ALL.panel
2020-04-18: runall.sh pca -f analysis/2020-04-16_mergePca/final_vcf.vcf.gz
2020-04-20: breakseq test worked wonderfully. I'll download the rest of the files. The list is in data/raw/avery_SRA_accessionlist/accession_list.txt but I won't make it automatic due to space issues. I'll put a runall option to do all the downloading and saving into crick.
2020-04-20: runall.sh dbgap -d SRR10140453: Didn't work because license was obsolete 
2020-04-20: runall.sh pcaplot -f analysis/2020-04-18_04_runPca/pcaResult.Rdata -p data/raw/1000genomes_hg19/integrated_call_samples_v3.20130502.ALL.panel
2020-04-21: Manually added previous reports.
2020-04-21: Created or moved parameter and imput files for imputation:
	# Manually copied directory data/raw/1000genomes_hg19_maps
	# Manually copied data/use/avery_individuals/samples_population.txt
	# Changed data/use/avery_individuals/samples_population.txt to make individual 25 AFR
	# Manually copied `inversions_info` into raw and use data.
	mkdir data/use/conditions
	# Manually created imputConditions.txt
2020-04-21: Added IMPUTE2 to the software directory. 
2020-04-21: Added QCTool to the software directory.
2020-04-22: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 10: there was a small error in the output files - a tab at the end of each line
2020-04-24: runall.sh impute -f data/use/conditions/inversionToImpute.txt -x data/use/conditions/imputConditions.txt -r data/raw/1000genomes_hg19 -m data/raw/1000genomes_hg19_maps -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all_genotypes.csv -s 10: solved the error with the new code but using just the requied bits and maintaining the previous date to avoid re-running all the imputation
2020-04-26: runall.sh imputetables -i analysis/2020-04-22_06_imputation/ -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt
2020-04-27: Manually created conditions for tag SNP checking
2020-04-27: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv -s 10: there was a small error in the output file concatenation. DISCARDED to have the same format in all of them.
2020-04-28: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i data/use/avery_individuals -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv -s 10:  solved the error with the new code but using just the requied bits and maintaining the previous date to avoid re-running all the tag SNPs check. DISCARDED to have the same format in all of them. 
2020-04-28: I did a summary genotype file with R:
	R 
			one<-read.table("data/use/inversions_info/all_genotypes.csv", sep = "\t", header = TRUE)
			two<-read.table("analysis/2020-04-26_07_imputationTables/new_genotypes.csv", header = TRUE)
			colnames(two)[1]<-colnames(one)[1]
			genotypes<-plyr::rbind.fill(one, two)
			write.table(genotypes,   "data/use/inversions_info/all+new_genotypes.csv", quote = FALSE, sep = "\t", na = ".", row.names = FALSE, col.names = TRUE) 
2020-04-28: Manually added a population file to analysis/2020-04-16_mergePca to use this dataset 
2020-04-28: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 10. DISCARDED to have the same format in all of them.
2020-04-28: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 10. DISCARDED to have the same format in all of them.
2020-04-29: Manually added information related to inversions in hg38
2020-04-29: Manually updated data READMEs
2020-05-05: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv. DISCARDED - see 2020-07-07
2020-05-06: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -g analysis/2020-04-26_07_imputationTables/new_genotypes.csv. DISCARDED - see 2020-07-07
2020-05-11: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 3: SAS population. DISCARDED because there were evident errors in such big files.
2020-05-12: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 5: other populations. DISCARDED because there were evident errors in such big files.
2020-05-13: runall.sh tagsnps -f data/use/conditions/inversionToTag.txt -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 7: ALL population. DISCARDED because there were evident errors in such big files.
2020-05-17: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes.csv -s 10: DISCARDED because there was an error in the data that made almos all SNPs missing.
2020-05-23: runall.sh imputetables -i analysis/2020-04-22_06_imputation/ -p data/use/avery_individuals/samples_population.txt -t data/use/inversions_info/Inversions_imputability.txt. This applied less strict filters to imputation results.
2020-05-23: I did a summary genotype file with R:
	R 
			one<-read.table("data/use/inversions_info/all_genotypes.csv", sep = "\t", header = TRUE)
			two<-read.table("analysis/2020-05-23_07_imputationTables/new_genotypes.csv", header = TRUE)
			colnames(two)[1]<-colnames(one)[1]
			genotypes<-plyr::rbind.fill(one, two)
			write.table(genotypes,   "data/use/inversions_info/all+new_genotypes_lessStrict.csv", quote = FALSE, sep = "\t", na = ".", row.names = FALSE, col.names = TRUE) 
2020-05-23: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/Inversions_coordinates_hg19.csv -g data/use/inversions_info/all+new_genotypes_lessStrict.csv -s 8
2020-05-23: runall.sh tagsnps -f data/raw/inversions_info/TagVs_INVs_v4.7 -x data/use/conditions/populationToTag.txt -i analysis/2020-04-16_mergePca/ -c data/use/inversions_info/
2020-05-29: Manually copied data/use/assembly_hg38/gap.txt
2020-05-29: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-06-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-06-30: manually changed the name to 2020-06-30_09_crossovers_fixed. DISCARDED - see 2020-07-07
2020-06-30: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-06-30: manually changed the name to 2020-06-30_09_crossovers_proportional. DISCARDED - see 2020-07-07
2020-07-01: awk '$2 == 0 {a[$1]=$3}; $4 == "telomere" && $2 !=0 {print $1,a[$1] , $2}' data/use/assembly_hg38/gap.txt | grep -v "chrX" | grep -v "chrY" | awk -v OFS="\t" '{}{print $1,"InvFEST", "inversion",$2, $3, ".",".",".",$1 }' > data/use/assembly_hg38/cromlength.txt
2020-07-01: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-07-01: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -r data/use/assembly_hg38/ -x data/use/conditions/winsize.txt. DISCARDED - see 2020-07-07
2020-07-07: Discarded all previous crossover tests because I want brand new ones. 
2020-07-14: data/use/avery_crossovers/numOfCells.txt was manually created. Columns: individual \t numberofcells
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_inv10kb
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/inversions_info/2020.02.inversions_hg38.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_inv50kb
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_generalMap
2020-07-14: runall.sh crossovers -f data/raw/avery_crossovers/allcrossovers_hg38.txt.gz -c data/use/assembly_hg38/cromlength.gff -n data/use/avery_crossovers/numOfCells.txt -x data/use/conditions/winsizeCrossovers.txt. Manually changed to 2020-07-14_09_crossovers_byChromosome
