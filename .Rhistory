& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0003"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
coords
croxinv$inversion
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0004"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0004"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
coords
croxinv$inversion
croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")]
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0014"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
coords
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0014"
View(croxinv)
myinv<-"HsInv0040"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
myinv<-"HsInv0266"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
buffer
myinv<-"HsInv040"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
buffer
myinv<-"HsInv040"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
coords
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0040"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
myinv<-"HsInv0040"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
coords
buffer<-(coords$bp2e-coords$bp1s)
buffer
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv1867"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0097"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0095"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
numofsamples<-read.table("report/2020-04-29_statisticalPreliminary/numofsamples.txt", stringsAsFactors = FALSE)
colnames(numofsamples)<-c("donor", "samples")
# 1 hacer ventanas
multiplyer<-10
myinv<-"HsInv0095"
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
coords
coords<-croxinv[croxinv$inversion == myinv, c("chromosome", "bp1s", "bp2e")][1,]
coords
coords<-croxinv[croxinv$inversion == myinv & !is.na(croxinv$chromosome), c("chromosome", "bp1s", "bp2e")][1,]
coords
buffer<-(coords$bp2e-coords$bp1s)
windows<-seq(from = coords$bp1s-(buffer*multiplyer), to = coords$bp2e+(buffer*multiplyer), length.out=(multiplyer*2)+2)
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples)
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
# 2 buscar los que solapan para cada ventana
here<-data.frame(windowstart=windows[1:length(windows)-1], windowend=windows[2:length(windows)] )
here$chromosome<-coords$chromosome
here$HETprob<-here$STDprob<-here$INVprob<-NA
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
counts
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
tmp
View(tmp)
here
row<-11
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
myrow
tmp
colnames(counts)<-c("donor", "crossovers")
counts<-data.frame(table(tmp$donor))
counts
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples, all=TRUE)
counts
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
counts
counts[is.na(counts$crossovers),"crossovers"]<-0
counts
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
here
for (row in rownames(here)) {
myrow<-here[row,]
tmp<-crossovers_raw[
( (crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) |
(crossovers_raw$pos.leftbound <= myrow$windowstart
& crossovers_raw$pos.rightbound >= myrow$windowend) |
(crossovers_raw$pos.leftbound >= myrow$windowstart
& crossovers_raw$pos.leftbound <= myrow$windowend) |
(crossovers_raw$pos.rightbound >= myrow$windowstart
& crossovers_raw$pos.rightbound <= myrow$windowend) )
& crossovers_raw$chr == myrow$chromosome,]
counts<-data.frame(table(tmp$donor))
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples, all=TRUE)
counts[is.na(counts$crossovers),"crossovers"]<-0
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts<-counts[counts$value != ".",]
het<-sum(counts[counts$value == "HET","crossovers"])/sum(counts[counts$value == "HET","samples"])
std<-sum(counts[counts$value == "STD","crossovers"])/sum(counts[counts$value == "STD","samples"])
inv<-sum(counts[counts$value == "INV","crossovers"])/sum(counts[counts$value == "INV","samples"])
here[row, c("HETprob", "STDprob", "INVprob")]<-c(het, std, inv)
}
here
plot<-melt(here, id.vars = c("windowstart", "windowend", "chromosome"))
plot$inversion<-NA
plot[plot$windowstart == coords$bp1s, "inversion"]<-myinv
ggplot(plot)+geom_bar(aes(x=windowstart, y = value, fill = inversion), stat = "identity")+
facet_grid(.~variable)+ggtitle("myinv")+
theme(legend.position = "none")
# anova
library(tidyverse)
library(ggpubr)
library(rstatix)
install.packages("rstatix")
# anova
library(tidyverse)
install.packages("tidyverse")
# anova
library(tidyverse)
library(ggpubr)
library(rstatix)
plot
boxplot(x = plot[!is.na(inversion),"variable"], y = plot[!is.na(inversion),"value"])
boxplot(x = plot[!is.na(plot$inversion),"variable"], y = plot[!is.na(plot$inversion),"value"])
ggplot(plot[!is.na(plot$inversion),])+geom_boxplot(aes(x = variable, y = value))
here
coords
myinv<-"HsInv0095"
coords<-croxinv[croxinv$inversion == myinv & !is.na(croxinv$chromosome), c("chromosome", "bp1s", "bp2e")][1,]
tmp<-croxinv[croxinv$inversion == myinv,]
tmp
counts<-data.frame(table(tmp$individual))
counts
colnames(counts)<-c("donor", "crossovers")
counts<-merge(counts, numofsamples, all=TRUE)
counts[is.na(counts$crossovers),"crossovers"]<-0
counts<-merge(counts, genotypes[genotypes$variable == myinv,], by.x = "donor", by.y = "Individual")
counts
counts<-counts[counts$value != ".",]
counts$weight<-counts$crossovers/counts$samples
counts
summary(counts)
counts$genotype<-factor(value, levels = c("STD", "INV", "HET"))
counts$genotype<-factor(counts$value, levels = c("STD", "INV", "HET"))
counts
levels(PlantGrowth$group)
levels(counts$genotype)
counts %>%
group_by(genotype) %>%
get_summary_stats(weight, type = "mean_sd")
library(rstatix)
install.packages("tibble")
library(rstatix)
summary(counts$weight)
ggboxplot(counts, x = "genotype", y = "weight")
install.packages("rstatix")
library(rstatix)
