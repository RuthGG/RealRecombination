require("knitr")
opts_knit$set(root.dir = "~/20200401_RealRecombination/")
setwd("~/20200401_RealRecombination/")
setwd("~/20200401_RealRecombination/")
setwd("../../")
weightMap<-read.table("analysis/2020-07-/windows_x_crossovers_weighted.txt")
require("knitr")
opts_knit$set(root.dir = "~/20200401_RealRecombination/")
weightMap<-read.table("analysis/2020-07-08_09_crossovers_generalMap/windows_x_crossovers_weighted.txt"")
"../../analysis/2020-07-08_09_crossovers_generalMap/windows_x_crossovers_weighted.txt"
makeMap<-function(weightMap){
# Make readable names
colnames(weightMap)<-c("chr_w", "start_w", "end_w", "inv","chr_e", "start_e", "end_e", "ind", "overlap", "score")
# Sum scores for each window, individual and inversion
weightMap$ind<-sub("_.*$","", weightMap$ind)
recMap<-aggregate(score ~ chr_w+start_w+end_w+ind+inv, data=weightMap, FUN=sum)
# Control by number of samples
numofsamples<-read.table("report/2020-04-29_statisticalPreliminary/numofsamples.txt", stringsAsFactors = FALSE)
colnames(numofsamples)<-c("ind", "samples")
recMap<-merge(recMap, numofsamples)
recMap$win_centiMorgans<-(recMap$score/recMap$samples)*100
recMap<-recMap[order(recMap$end_w),]
recMap.cumsum<-data.frame()
for (i in unique(recMap$ind)) {
tmp.i<-recMap[recMap$ind == i,]
for (c in unique(as.character(tmp.i$inv))) {
tmp.ic<-tmp.i[tmp.i$inv == c,]
tmp.ic<-tmp.ic[order(tmp.ic$end_w),]
tmp.ic$scorecum<-cumsum(tmp.ic$score)
recMap.cumsum<-rbind(recMap.cumsum, tmp.ic)
}
}
recMap.cumsum$centiMorgans<-(recMap.cumsum$scorecum/recMap.cumsum$samples)*100
return(recMap.cumsum)
}
```
weightMap<-read.table("analysis/2020-07-08_09_crossovers_generalMap/windows_x_crossovers_weighted.txt")
weightMap_test<-weightMap[1:10000,]
rm(weightMap)
weightMap<-weightMap_test
head(weightMap)
# LOAD ARGUMENTS
# =========================================================================== #
args = commandArgs(trailingOnly=TRUE)
